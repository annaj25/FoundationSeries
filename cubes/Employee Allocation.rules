skipcheck;

[]=If(ELISANC('Version','All Reporting Versions',!Version) =1,STET,Continue);

['Allocation Start (TM1)'] = N: If (DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation Start') @<> '',
	DayNo(
	SUBST(DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation Start'),7,4) | '-' |
	SUBST(DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation Start'),1,2) | '-' |
	SUBST(DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation Start'),4,2)),
	0);
['Allocation Start (Excel)'] = N: If (DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation Start') @<> '',
	['Allocation Start (TM1)'] + 21916,
	0);

['Allocation End (TM1)'] = N: If (DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation End') @<> '',
	DayNo(
	SUBST(DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation End'),7,4) | '-' |
	SUBST(DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation End'),1,2) | '-' |
	SUBST(DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation End'),4,2)),
	0);
['Allocation End (Excel)'] = N: If (DB('Employee Allocation', !Version, !Employee,!Department,  'Allocation End') @<> '',
	['Allocation End (TM1)'] + 21916,
	0);


feeders;

[Version:'Forecast','Allocation Start (TM1)'] => ['Allocation Start (Excel)'];
[Version:'Forecast','Allocation Start'] => ['Allocation Start (TM1)'];

[Version:'Forecast','Allocation End (TM1)'] => ['Allocation End (Excel)'];
[Version:'Forecast','Allocation End'] => ['Allocation End (TM1)'];


#Region External Feeders
#['Allocation Percentage'] => DB('Labor Forecast', !Version, !Employee, !Cost Center, 'FTE', 'All Months', 'All Years', 'Value');
[Version:'Forecast','Allocation Percentage'] => DB('Employee Department', !Version, !Employee, !Department, 'All Periods', 'FTE');
[Version:'Forecast','Allocation Percentage'] => DB('Employee Department', !Version, !Employee, !Department, 'All Periods', 'Home FTE');
#EndRegion